See http://fileadmin.cs.lth.se/cs/Personal/Tomas_Akenine-Moller/code/ for more information.